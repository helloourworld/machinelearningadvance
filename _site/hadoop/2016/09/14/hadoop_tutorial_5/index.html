<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="baidu-site-verification" content="g89MuzujW3" />
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="关于机器学习，关于大数据，关于你身边的金融，关于我们的生活... | LijunYu">
    <meta name="keywords"  content="LijunYu, 包包的老公, 大数据, 机器学习, CFA, Machine Learning(Deep Learning), Big Data, Spark">
    <link rel="stylesheet" href="/css/default.css" type="text/css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <link rel="alternatecss" type="application/rss+xml" title="“Lijun Yu's Blog”" href="http://helloourworld.github.io/feed.xml">
    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>

    <title>Hadoop 集群安装 快速指南 - Maching Learning | 机器学习笔记</title>

    <link rel="canonical" href="http://localhost:4000/hadoop/2016/09/14/hadoop_tutorial_5/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- ga & ba script hoook -->
    <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Big Data Memo</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/category/">Category</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                    <li>
                        <a href="/talks/">Talks</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/images/background.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/images/background.jpg')
    }

    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Big Data" title="Big Data">Big Data</a>
                        
                        <a class="tag" href="/tags/#大数据" title="大数据">大数据</a>
                        
                    </div>
                    <h1>Hadoop 集群安装 快速指南</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by Big Data Memo on September 14, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<h2 id="prerequisites">Prerequisites</h2>

<p>3台虚拟机
SSH免密登陆
Java已安装
Hadoop安装包已经下载
tools工具已经下载</p>

<h2 id="配置">配置</h2>

<p>配置分配目录：</p>

<table>
  <tbody>
    <tr>
      <td>目录</td>
      <td>说明</td>
    </tr>
    <tr>
      <td>hdfs</td>
      <td>存放hdfs相关文件，一般存放namenode、datanode、logs信息文件</td>
    </tr>
    <tr>
      <td>logs</td>
      <td>存放启动日志信息</td>
    </tr>
    <tr>
      <td>tmp</td>
      <td>存放hdfs系统临时文件等信息</td>
    </tr>
    <tr>
      <td>hdfs/name</td>
      <td>存放namenode信息</td>
    </tr>
    <tr>
      <td>hdfs/logs</td>
      <td>存放hdfs日志信息</td>
    </tr>
    <tr>
      <td>hdfs/data</td>
      <td>存放datanode信息</td>
    </tr>
  </tbody>
</table>

<p>使用hadoop用户身份，以安装2.7.3为例：</p>

<h3 id="1-建立以上目录">1 建立以上目录</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>hadoop@NN01 hadoop]<span class="nv">$ </span><span class="nb">cd</span> ~/hadoop-2.7.3/
<span class="o">[</span>hadoop@NN01 hadoop-2.7.3]<span class="nv">$ </span><span class="nb">ls
</span>bin  etc  include  lib  libexec  LICENSE.txt  NOTICE.txt  README.txt  sbin  share
<span class="o">[</span>hadoop@NN01 hadoop-2.7.3]<span class="nv">$ </span>~/tools/runRemoteCmd.sh <span class="s2">"mkdir ~/hadoop-2.7.3/hdfs ~/hadoop-2.7.3/logs ~/hadoop-2.7.3/tmp"</span> all
<span class="k">**************</span>NN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN02.HadoopVM<span class="k">************</span>
<span class="o">[</span>hadoop@NN01 hadoop-2.7.3]<span class="nv">$ </span>~/tools/runRemoteCmd.sh <span class="s2">"mkdir -p ~/hadoop-2.7.3/hdfs/data hadoop-2.7.3/hdfs/logs  hadoop-2.7.3/hdfs/name"</span> all
<span class="k">**************</span>NN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN02.HadoopVM<span class="k">************</span>
<span class="o">[</span>hadoop@NN01 hadoop-2.7.3]<span class="nv">$ </span><span class="nb">ls
</span>bin  etc  hdfs  include  lib  libexec  LICENSE.txt  logs  NOTICE.txt  README.txt  sbin  share  tmp
<span class="o">[</span>hadoop@NN01 hadoop-2.7.3]<span class="nv">$ </span><span class="nb">ls </span>hdfs
data  logs  name
</code></pre></div></div>

<h3 id="2-修改配置文件">2 修改配置文件</h3>

<p>Hadoop’s Java configuration is driven by two types of important configuration files:</p>

<ul>
  <li>Read-only default configuration - core-default.xml, hdfs-default.xml, yarn-default.xml and mapred-default.xml.</li>
  <li>Site-specific configuration - etc/hadoop/core-site.xml, etc/hadoop/hdfs-site.xml, etc/hadoop/yarn-site.xml and etc/hadoop/mapred-site.xml.</li>
</ul>

<p>Additionally, you can control the Hadoop scripts found in the bin/ directory of the distribution, by setting site-specific values via the etc/hadoop/hadoop-env.sh and etc/hadoop/yarn-env.sh.</p>

<p>To configure the Hadoop cluster you will need to configure the environment in which the Hadoop daemons execute as well as the configuration parameters for the Hadoop daemons.</p>

<p>HDFS daemons are NameNode, SecondaryNameNode, and DataNode. YARN damones are ResourceManager, NodeManager, and WebAppProxy. If MapReduce is to be used, then the MapReduce Job History Server will also be running. For large installations, these are generally running on separate hosts.</p>

<p><strong>注意：</strong>
修改配置前将hadoop-2.7.3软链接为hadoop</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>hadoop@NN01 ~]<span class="nv">$ </span>./tools/runRemoteCmd.sh <span class="s2">"ln -s hadoop-2.7.3 hadoop"</span> all
</code></pre></div></div>

<h4 id="21-修改etchadoopcore-sitexml">2.1 修改etc/hadoop/core-site.xml</h4>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>fs.defaultFS</td>
      <td>NameNode URI</td>
      <td>hdfs://host:port/</td>
    </tr>
    <tr>
      <td>io.file.buffer.size</td>
      <td>131072</td>
      <td>Size of read/write buffer used in SequenceFiles.</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
  &lt;property&gt;
      &lt;name&gt;fs.default.name&lt;/name&gt;
      &lt;value&gt;hdfs://NN01.HadoopVM:9000&lt;/value&gt;
      &lt;final&gt;true&lt;/final&gt;
  &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
      &lt;value&gt;file:///home/hadoop/hadoop/tmp&lt;/value&gt;
      &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;ds.default.name&lt;/name&gt;
      &lt;value&gt;hdfs://NN01.HadoopVM:54310&lt;/value&gt;
      &lt;final&gt;true&lt;/final&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:2181,DN01.HadoopVM:2181,DN02.HadoopVM:2181&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<h4 id="22-修改etchadoophdfs-sitexml">2.2 修改etc/hadoop/hdfs-site.xml</h4>

<p><strong>Configurations for NameNode:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>dfs.namenode.name.dir</td>
      <td>Path on the local filesystem where the NameNode stores the namespace and transactions logs persistently.</td>
      <td>If this is a comma-delimited list of directories then the name table is replicated in all of the directories, for redundancy.</td>
    </tr>
    <tr>
      <td>dfs.hosts / dfs.hosts.exclude</td>
      <td>List of permitted/excluded DataNodes.</td>
      <td>If necessary, use these files to control the list of allowable datanodes.</td>
    </tr>
    <tr>
      <td>dfs.blocksize</td>
      <td>268435456</td>
      <td>HDFS blocksize of 256MB for large file-systems.</td>
    </tr>
    <tr>
      <td>dfs.namenode.handler.count</td>
      <td>100</td>
      <td>More NameNode server threads to handle RPCs from large number of DataNodes.</td>
    </tr>
  </tbody>
</table>

<p><strong>Configurations for DataNode:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>dfs.datanode.data.dir</td>
      <td>Comma separated list of paths on the local filesystem of a DataNode where it should store its blocks.</td>
      <td>If this is a comma-delimited list of directories, then data will be stored in all named directories, typically on different devices.</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
  &lt;property&gt;
      &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;
      &lt;value&gt;file:/home/hadoop/hadoop/hdfs/name&lt;/value&gt;
      &lt;final&gt;true&lt;/final&gt;
  &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;
      &lt;value&gt;file:/home/hadoop/hadoop/hdfs/data&lt;/value&gt;
      &lt;final&gt;true&lt;/final&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;dfs.replication&lt;/name&gt;
      &lt;value&gt;2&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<h4 id="23-修改etchadoopyarn-sitexml">2.3 修改etc/hadoop/yarn-site.xml</h4>

<p><strong>Configurations for ResourceManager and NodeManager:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>yarn.acl.enable</td>
      <td>true /false</td>
      <td>Enable ACLs? Defaults to false.</td>
    </tr>
    <tr>
      <td>yarn.admin.acl</td>
      <td>Admin ACL</td>
      <td>ACL to set admins on the cluster. ACLs are of for comma-separated-usersspacecomma-separated-groups. Defaults to special value of * which meansanyone. Special value of just space means no one has access.</td>
    </tr>
    <tr>
      <td>yarn.log-aggregation-enable</td>
      <td>FALSE</td>
      <td>Configuration to enable or disable log aggregation</td>
    </tr>
  </tbody>
</table>

<p><strong>Configurations for ResourceManager:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.address</td>
      <td>ResourceManager host:port for clients to submit jobs.</td>
      <td>host:port If set, overrides the hostname set in yarn.resourcemanager.hostname.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.scheduler.address</td>
      <td>ResourceManager host:port for ApplicationMasters to talk to Scheduler to obtain resources.</td>
      <td>host:port If set, overrides the hostname set in yarn.resourcemanager.hostname.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.resource-tracker.address</td>
      <td>ResourceManager host:port for NodeManagers.</td>
      <td>host:port If set, overrides the hostname set in yarn.resourcemanager.hostname.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.admin.address</td>
      <td>ResourceManager host:port for administrative commands.</td>
      <td>host:port If set, overrides the hostname set in yarn.resourcemanager.hostname.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.webapp.address</td>
      <td>ResourceManager web-ui host:port.</td>
      <td>host:port If set, overrides the hostname set in yarn.resourcemanager.hostname.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.hostname</td>
      <td>ResourceManager host.</td>
      <td>host Single hostname that can be set in place of setting all yarn.resourcemanager*addressresources. Results in default ports for ResourceManager components.</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.scheduler.class</td>
      <td>ResourceManager Scheduler class.</td>
      <td>CapacityScheduler (recommended), FairScheduler (also recommended), or FifoScheduler</td>
    </tr>
    <tr>
      <td>yarn.scheduler.minimum-allocation-mb</td>
      <td>Minimum limit of memory to allocate to each container request at the Resource Manager.</td>
      <td>In MBs</td>
    </tr>
    <tr>
      <td>yarn.scheduler.maximum-allocation-mb</td>
      <td>Maximum limit of memory to allocate to each container request at the Resource Manager.</td>
      <td>In MBs</td>
    </tr>
    <tr>
      <td>yarn.resourcemanager.nodes.include-path /yarn.resourcemanager.nodes.exclude-path</td>
      <td>List of permitted/excluded NodeManagers.</td>
      <td>If necessary, use these files to control the list of allowable NodeManagers.</td>
    </tr>
  </tbody>
</table>

<p><strong>Configurations for NodeManager:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.resource.memory-mb</td>
      <td>Resource i.e. available physical memory, in MB, for given NodeManager</td>
      <td>Defines total available resources on the NodeManager to be made available to running containers</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.vmem-pmem-ratio</td>
      <td>Maximum ratio by which virtual memory usage of tasks may exceed physical memory</td>
      <td>The virtual memory usage of each task may exceed its physical memory limit by this ratio. The total amount of virtual memory used by tasks on the NodeManager may exceed its physical memory usage by this ratio.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.local-dirs</td>
      <td>Comma-separated list of paths on the local filesystem where intermediate data is written.</td>
      <td>Multiple paths help spread disk i/o.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.log-dirs</td>
      <td>Comma-separated list of paths on the local filesystem where logs are written.</td>
      <td>Multiple paths help spread disk i/o.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.log.retain-seconds</td>
      <td>10800</td>
      <td>Default time (in seconds) to retain log files on the NodeManager Only applicable if log-aggregation is disabled.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.remote-app-log-dir</td>
      <td>/logs</td>
      <td>HDFS directory where the application logs are moved on application completion. Need to set appropriate permissions. Only applicable if log-aggregation is enabled.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.remote-app-log-dir-suffix</td>
      <td>logs</td>
      <td>Suffix appended to the remote log dir. Logs will be aggregated to ${yarn.nodemanager.remote-app-log-dir}/${user}/${thisParam} Only applicable if log-aggregation is enabled.</td>
    </tr>
    <tr>
      <td>yarn.nodemanager.aux-services</td>
      <td>mapreduce_shuffle</td>
      <td>Shuffle service that needs to be set for Map Reduce applications.</td>
    </tr>
  </tbody>
</table>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;<span class="o">!</span><span class="nt">--</span> Site specific YARN configuration properties <span class="nt">--</span><span class="o">&gt;</span>
&lt;configuration&gt;
  &lt;property&gt;
      &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
      &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;
      &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.address&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:8032&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.scheduler.address&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:8030&lt;/value&gt;
  &lt;/property&gt;
      &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.resource-tracker.address&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:8031&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.admin.address&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:8033&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;
      &lt;value&gt;NN01.HadoopVM:8088&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<h4 id="24-修改etchadoopmapred-sitexml">2.4 修改etc/hadoop/mapred-site.xml</h4>

<p><strong>Configurations for MapReduce Applications:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>mapreduce.framework.name</td>
      <td>yarn</td>
      <td>Execution framework set to Hadoop YARN.</td>
    </tr>
    <tr>
      <td>mapreduce.map.memory.mb</td>
      <td>1536</td>
      <td>Larger resource limit for maps.</td>
    </tr>
    <tr>
      <td>mapreduce.map.java.opts</td>
      <td>-Xmx1024M</td>
      <td>Larger heap-size for child jvms of maps.</td>
    </tr>
    <tr>
      <td>mapreduce.reduce.memory.mb</td>
      <td>3072</td>
      <td>Larger resource limit for reduces.</td>
    </tr>
    <tr>
      <td>mapreduce.reduce.java.opts</td>
      <td>-Xmx2560M</td>
      <td>Larger heap-size for child jvms of reduces.</td>
    </tr>
    <tr>
      <td>mapreduce.task.io.sort.mb</td>
      <td>512</td>
      <td>Higher memory-limit while sorting data for efficiency.</td>
    </tr>
    <tr>
      <td>mapreduce.task.io.sort.factor</td>
      <td>100</td>
      <td>More streams merged at once while sorting files.</td>
    </tr>
    <tr>
      <td>mapreduce.reduce.shuffle.parallelcopies</td>
      <td>50</td>
      <td>Higher number of parallel copies run by reduces to fetch outputs from very large number of maps.</td>
    </tr>
  </tbody>
</table>

<p><strong>Configurations for MapReduce JobHistory Server:</strong></p>

<table>
  <tbody>
    <tr>
      <td>Parameter</td>
      <td>Value</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>mapreduce.jobhistory.address</td>
      <td>MapReduce JobHistory Server host:port</td>
      <td>Default port is 10020.</td>
    </tr>
    <tr>
      <td>mapreduce.jobhistory.webapp.address</td>
      <td>MapReduce JobHistory Server Web UI host:port</td>
      <td>Default port is 19888.</td>
    </tr>
    <tr>
      <td>mapreduce.jobhistory.intermediate-done-dir</td>
      <td>/mr-history/tmp</td>
      <td>Directory where history files are written by MapReduce jobs.</td>
    </tr>
    <tr>
      <td>mapreduce.jobhistory.done-dir</td>
      <td>/mr-history/done</td>
      <td>Directory where history files are managed by the MR JobHistory Server.</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
   &lt;property&gt;
          &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
          &lt;value&gt;yarn&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
          &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
          &lt;value&gt;NN01.HadoopVM:10020&lt;/value&gt;
   &lt;/property&gt;
   &lt;property&gt;
          &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
          &lt;value&gt;NN01.HadoopVM:19888&lt;/value&gt;
   &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<h4 id="25-修改masters-slaves">2.5 修改masters slaves</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 hadoop]$ cat masters
NN01.HadoopVM
[hadoop@NN01 hadoop]$ cat slaves
NN01.HadoopVM

DN01.HadoopVM
DN02.HadoopVM
</code></pre></div></div>

<h4 id="26-增加执行权限">2.6 增加执行权限</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 hadoop]$ chmod +x *.sh
</code></pre></div></div>

<h4 id="27-环境配置">2.7 环境配置</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export JAVA_HOME=/opt/tool/jdk1.8
export PATH=$JAVA_HOME/bin:$PATH
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export HADOOP_HOME=/home/hadoop/hadoop
export PATH=$PATH:$HADOOP_HOME/bin
export HADOOP_LOG_DIR=/home/hadoop/hadoop/logs
export YARN_LOG_DIR=$HADOOP_LOG_DIR
export HADOOP_PREFIX=$HADOOP_HOME
export HADOOP_CONF_DIR=/home/hadoop/hadoop/etc/hadoop
export HADOOP_YARN_HOME=$HADOOP_HOME
export HADOOP_CLASSPATH=$JAVA_HOME/lib/tools.jar
</code></pre></div></div>

<h4 id="28-修改yarn-envsh">2.8 修改yarn-env.sh</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export JAVA_HOME=/opt/tool/jdk1.8
</code></pre></div></div>

<h3 id="3-hadoop-startup">3 Hadoop Startup</h3>

<p>The first time you bring up HDFS, it must be formatted. Format a new distributed filesystem as hdfs:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hdfs]$ $HADOOP_PREFIX/bin/hdfs namenode -format &lt;cluster_name&gt;
</code></pre></div></div>

<p>Start HDFS AND YARN</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 sbin]$ ./start-dfs.sh
Starting namenodes on [NN01.HadoopVM]
NN01.HadoopVM: starting namenode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-namenode-NN01.HadoopVM.out
DN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN01.HadoopVM.out
NN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-NN01.HadoopVM.out
DN02.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN02.HadoopVM.out
Starting secondary namenodes [0.0.0.0]
0.0.0.0: starting secondarynamenode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-secondarynamenode-NN01.HadoopVM.out
[hadoop@NN01 sbin]$ ./start-yarn.sh
starting yarn daemons
starting resourcemanager, logging to /home/hadoop/hadoop/logs/yarn-hadoop-resourcemanager-NN01.HadoopVM.out
NN01.HadoopVM: starting nodemanager, logging to /home/hadoop/hadoop/logs/yarn-hadoop-nodemanager-NN01.HadoopVM.out
DN01.HadoopVM: starting nodemanager, logging to /home/hadoop/hadoop/logs/yarn-hadoop-nodemanager-DN01.HadoopVM.out
DN02.HadoopVM: starting nodemanager, logging to /home/hadoop/hadoop/logs/yarn-hadoop-nodemanager-DN02.HadoopVM.out
</code></pre></div></div>

<p>Start the MapReduce JobHistory Server with the following command, run on the designated server as mapred:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 sbin]$ $HADOOP_PREFIX/sbin/mr-jobhistory-daemon.sh --config $HADOOP_CONF_DIR start historyserver
starting historyserver, logging to /home/hadoop/hadoop/logs/mapred-hadoop-historyserver-NN01.HadoopVM.out
</code></pre></div></div>

<p>Web Interfaces</p>

<p>Once the Hadoop cluster is up and running check the web-ui of the components as described below:</p>

<table>
  <tbody>
    <tr>
      <td>Daemon</td>
      <td>Web Interface</td>
      <td>Notes</td>
    </tr>
    <tr>
      <td>NameNode</td>
      <td>http://nn_host:port/</td>
      <td>Default HTTP port is 50070.</td>
    </tr>
    <tr>
      <td>ResourceManager</td>
      <td>http://rm_host:port/</td>
      <td>Default HTTP port is 8088.</td>
    </tr>
    <tr>
      <td>MapReduce JobHistory Server</td>
      <td>http://jhs_host:port/</td>
      <td>Default HTTP port is 19888.</td>
    </tr>
  </tbody>
</table>

<h3 id="4-hadoop-shutdown">4 Hadoop Shutdown</h3>

<p>Stop HDFS AND YARN</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 sbin]$ ./stop-dfs.sh
Stopping namenodes on [NN01.HadoopVM]
NN01.HadoopVM: stopping namenode
NN01.HadoopVM: stopping datanode
DN01.HadoopVM: stopping datanode
DN02.HadoopVM: stopping datanode
Stopping secondary namenodes [0.0.0.0]
0.0.0.0: stopping secondarynamenode
[hadoop@NN01 sbin]$ ./stop-yarn.sh
stopping yarn daemons
stopping resourcemanager
NN01.HadoopVM: stopping nodemanager
DN01.HadoopVM: stopping nodemanager
DN02.HadoopVM: stopping nodemanager
</code></pre></div></div>

<p>Stop the MapReduce JobHistory Server with the following command, run on the designated server as mapred:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 sbin]$ $HADOOP_PREFIX/sbin/mr-jobhistory-daemon.sh --config $HADOOP_CONF_DIR stop historyserver
stopping historyserver
</code></pre></div></div>

<h3 id="5-hadoop版本切换">5 Hadoop版本切换</h3>

<p>按照上述配置，配置另一套Hadoop环境于相同节点上。</p>

<p><strong>查看目前版本状态</strong></p>

<p><img src="/images/hadoop/hadoop2.7.3.png" alt="" /></p>

<p><strong>切换</strong></p>

<p>即将软链接改为指向2.6.4即可</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>hadoop@NN01 ~]<span class="nv">$ </span>./tools/runRemoteCmd.sh <span class="s2">"rm ~/hadoop"</span> all
<span class="k">**************</span>NN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN02.HadoopVM<span class="k">************</span>
<span class="o">[</span>hadoop@NN01 ~]<span class="nv">$ </span>./tools/runRemoteCmd.sh <span class="s2">"ln -s ~/hadoop2.6 ~/hadoop"</span> all
<span class="k">**************</span>NN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN01.HadoopVM<span class="k">************</span>
<span class="k">**************</span>DN02.HadoopVM<span class="k">************</span>
</code></pre></div></div>

<p><strong>查看目前版本状态</strong></p>

<p><img src="/images/hadoop/hadoop2.6.4.png" alt="" /></p>

<h3 id="6-other">6 Other</h3>

<p>配置SecondaryNameNode</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 hadoop]$ tail etc/hadoop/hdfs-site.xml
...
  &lt;property&gt;
    &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;
    &lt;value&gt;DN01.HadoopVM:50090&lt;/value&gt;
  &lt;/property&gt;
[hadoop@NN01 hadoop]$ ./sbin/start-dfs.sh
Starting namenodes on [NN01.HadoopVM]
NN01.HadoopVM: starting namenode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-namenode-NN01.HadoopVM.out
NN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-NN01.HadoopVM.out
DN02.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN02.HadoopVM.out
DN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN01.HadoopVM.out
Starting secondary namenodes [DN01.HadoopVM]
DN01.HadoopVM: starting secondarynamenode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-secondarynamenode-DN01.HadoopVM.out
[hadoop@DN01 current]$ jps
4504 DataNode
4570 SecondaryNameNode
</code></pre></div></div>

<p>故障恢复</p>

<p>The latest checkpoint can be imported to the NameNode if all other copies of the image and the edits files are lost. In order to do that one should:</p>

<ul>
  <li>Create an empty directory specified inthedfs.namenode.name.dir configuration variable;</li>
  <li>Specify the location of the checkpointdirectory in the configuration variabledfs.namenode.checkpoint.dir;</li>
  <li>and start the NameNode with-importCheckpoint option.</li>
</ul>

<p>The NameNode will upload the checkpoint from the dfs.namenode.checkpoint.dir directory and then save it to the NameNode directory(s) set in dfs.namenode.name.dir. The NameNodewill fail if a legal image is contained in dfs.namenode.name.dir. The NameNode verifies that the image indfs.namenode.checkpoint.dir is consistent, but does not modify it in any way.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[hadoop@NN01 hdfs]$ $HADOOP_PREFIX/sbin/hadoop-daemon.sh --config $HADOOP_CONF_DIR --script hdfs start namenode -importCheckpoint
starting namenode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-namenode-NN01.HadoopVM.out
[hadoop@NN01 hdfs]$ jps
11571 Jps
11530 NameNode
[hadoop@NN01 hdfs]$ $HADOOP_PREFIX/sbin/hadoop-daemons.sh --config $HADOOP_CONF_DIR --script hdfs start datanode
DN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN01.HadoopVM.out
DN02.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-DN02.HadoopVM.out
NN01.HadoopVM: starting datanode, logging to /home/hadoop/hadoop/logs/hadoop-hadoop-datanode-NN01.HadoopVM.out
</code></pre></div></div>


                <hr>


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/2016/09/13/Setup-passphraseless-ssh/" data-toggle="tooltip" data-placement="top" title="Setup passphraseless ssh">
                        Previous<br>
                        <span>Setup passphraseless ssh</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/cfa/2016/09/15/CFALevel2_Qunat_1/" data-toggle="tooltip" data-placement="top" title="Lev2 Quant 1">
                        Next<br>
                        <span>Lev2 Quant 1</span>
                        </a>
                    </li>
                    
                </ul>
                    <div class="ds-share flat"
                    <div class="ds-thread"
                        data-thread-key="/hadoop/2016/09/14/hadoop_tutorial_5"
                        data-title="Hadoop 集群安装 快速指南"
                        data-url="http://localhost:4000/hadoop/2016/09/14/hadoop_tutorial_5/" >
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">

                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
                        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
                        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
                        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                 </div>
                
                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread"
                        data-thread-key="/hadoop/2016/09/14/hadoop_tutorial_5"
                        data-title="Hadoop 集群安装 快速指南"
                        data-url="http://localhost:4000/hadoop/2016/09/14/hadoop_tutorial_5/" >
                    </div>

                </div>
                <!-- 多说评论框 end -->
                

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

            </div>

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#Machine Learning" title="Machine Learning" rel="27">
                                Machine Learning
                                </a>
                            
        				
                            
                				<a href="/tags/#Spark" title="Spark" rel="23">
                                Spark
                                </a>
                            
        				
                            
                				<a href="/tags/#ME" title="ME" rel="4">
                                ME
                                </a>
                            
        				
                            
                				<a href="/tags/#Other" title="Other" rel="4">
                                Other
                                </a>
                            
        				
                            
                				<a href="/tags/#CFAL1" title="CFAL1" rel="9">
                                CFAL1
                                </a>
                            
        				
                            
                				<a href="/tags/#Python" title="Python" rel="26">
                                Python
                                </a>
                            
        				
                            
                				<a href="/tags/#maths" title="maths" rel="2">
                                maths
                                </a>
                            
        				
                            
                				<a href="/tags/#Baby" title="Baby" rel="2">
                                Baby
                                </a>
                            
        				
                            
                				<a href="/tags/#Big Data" title="Big Data" rel="23">
                                Big Data
                                </a>
                            
        				
                            
                				<a href="/tags/#大数据" title="大数据" rel="21">
                                大数据
                                </a>
                            
        				
                            
                				<a href="/tags/#IT" title="IT" rel="10">
                                IT
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#Scala" title="Scala" rel="24">
                                Scala
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#English" title="English" rel="23">
                                English
                                </a>
                            
        				
                            
                				<a href="/tags/#wordcloud" title="wordcloud" rel="3">
                                wordcloud
                                </a>
                            
        				
                            
                				<a href="/tags/#quant" title="quant" rel="3">
                                quant
                                </a>
                            
        				
                            
                				<a href="/tags/#python" title="python" rel="2">
                                python
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Clustering" title="Clustering" rel="3">
                                Clustering
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#ML" title="ML" rel="2">
                                ML
                                </a>
                            
        				
                            
                				<a href="/tags/#Graphx" title="Graphx" rel="3">
                                Graphx
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="https://www.kaggle.com/">Your Home for Data Science</a></li>
                    
                        <li><a href="https://www.analyticsvidhya.com/">Analytics Vidhya</a></li>
                    
                        <li><a href="https://www.cfainstitute.org/pages/index.aspx">CFA</a></li>
                    
                        <li><a href="http://www.garp.org/#!/home">GARP</a></li>
                    
                        <li><a href="http://www.investopedia.com/">Investopedia</a></li>
                    
                        <li><a href="https://www.quantstart.com/">Quant Start</a></li>
                    
                        <li><a href="http://muchong.com/bbs/">muchong</a></li>
                    
                        <li><a href="https://www.coursera.org/learn/machine-learning">Coursera</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>
<script type="text/javascript"  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"machinelearningadvance"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- 多说公共JS代码 end -->
<!-- 多说公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/u/2672280861">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    <li>
                        <a target="_blank" href="https://www.facebook.com/davidyjun">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/helloourworld">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/lijun-yu-13b9b475">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Big Data Memo 2018
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-82819752-1';
    var _gaDomain = 'machinelearningadvance.com';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '863b1f46c83a8e14e47782106aee7e7f';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>





<!-- Image to hack wechat -->
<img src="/images/background.jpg" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
